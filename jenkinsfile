pipeline {
    agent any

    stages {
        stage('Check Connections') {
            steps {
                script {
                    def services = [
                        'mi_nginx_nuevo:8080',
                        'sonarqube2:9000',
                        'my_container:latest',
                        'temp-container:latest',
                        'ping-container:latest',
                        'wonderful_goldberg:80',
                        'confident_shamir:80',
                        'owasp-zap:latest',
                        'jenkins:8081',
                        'nginx:8082'
                    ]

                    for (service in services) {
                        def serviceName = service.split(':')[0]
                        def port = service.split(':')[1]
                        sh "nc -zv $serviceName $port"
                    }
                }
            }
        }
    }
}
